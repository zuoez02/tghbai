<?php
#define	阿拉善左旗 	101081201
#define	霍林郭勒 	101081108
#define	突泉 	101081107
#define	索伦 	101081106
#define	扎赉特旗 	101081105
#define	胡尔勒 	101081104
#define	科尔沁右翼中旗 	101081103
#define	阿尔山 	101081102
#define	乌兰浩特 	101081101
#define	图里河 	101081016
#define	根河 	101081015
#define	额尔古纳 	101081014
#define	扎兰屯 	101081012
#define	牙克石 	101081011
#define	满洲里 	101081010
#define	新巴尔虎右旗 	101081009
#define	新巴尔虎左旗 	101081008
#define	陈巴尔虎旗 	101081007
#define	鄂温克旗 	101081006
#define	鄂伦春旗 	101081005
#define	莫力达瓦旗 	101081004
#define	阿荣旗 	101081003
#define	小二沟 	101081002
#define	海拉尔 	101081001
#define	呼伦贝尔 	101081000
#define	那日图 	101080919
#define	白日乌拉 	101080918
#define	乌拉盖 	101080917
#define	博克图 	101080916
#define	多伦 	101080915
#define	正兰旗 	101080914
#define	正镶白旗 	101080913
#define	镶黄旗 	101080912
#define	太仆寺旗 	101080911
#define	西乌珠穆沁旗 	101080910
#define	东乌珠穆沁旗 	101080909
#define	朱日和 	101080908
#define	苏尼特右旗 	101080907
#define	苏尼特左旗 	101080906
#define	伊和郭勒 	101080905
#define	阿巴嘎旗 	101080904
#define	二连浩特 	101080903
#define	朝克乌拉 	101080902
#define	锡林浩特 	101080901
#define	巴盟农试站 	101080811
#define	杭锦后旗 	101080810
#define	那仁宝力格 	101080809
#define	海力素 	101080808
#define	乌拉特后旗 	101080807
#define	乌拉特中旗 	101080806
#define	大佘太 	101080805
#define	乌拉特前旗 	101080804
#define	磴口 	101080803
#define	五原 	101080802
#define	临河 	101080801
#define	东胜 	101080713
#define	乌审召 	101080712
#define	伊金霍洛旗 	101080711
#define	乌审旗 	101080710
#define	杭锦旗 	101080709
#define	鄂托克旗 	101080708
#define	伊克乌素 	101080707
#define	河南 	101080706
#define	鄂托克前旗 	101080705
#define	准格尔旗 	101080704
#define	达拉特旗 	101080703
#define	鄂尔多斯 	101080701
#define	宝过图 	101080615
#define	敖汉旗 	101080614
#define	宁城 	101080613
#define	八里罕 	101080612
#define	喀喇沁旗 	101080611
#define	岗子 	101080610
#define	翁牛特旗 	101080609
#define	克什克腾旗 	101080608
#define	林西 	101080607
#define	巴林右旗 	101080606
#define	巴林左旗 	101080605
#define	浩尔吐 	101080604
#define	阿鲁科尔沁旗 	101080603
#define	赤峰郊区站 	101080602
#define	赤峰 	101080601
#define	通辽钱家店 	101080512
#define	巴雅尔吐胡硕 	101080511
#define	高力板 	101080510
#define	扎鲁特旗 	101080509
#define	奈曼旗 	101080508
#define	库伦旗 	101080507
#define	开鲁 	101080506
#define	青龙山 	101080505
#define	科尔沁左翼后旗 	101080504
#define	科尔沁左翼中旗 	101080503
#define	舍伯吐 	101080502
#define	通辽 	101080501
#define	丰镇 	101080412
#define	四子王旗 	101080411
#define	察哈尔右翼后旗 	101080410
#define	察哈尔右翼中旗 	101080409
#define	察哈尔右翼前旗 	101080408
#define	凉城 	101080407
#define	兴和 	101080406
#define	希拉穆仁 	101080405
#define	商都 	101080404
#define	化德 	101080403
#define	卓资 	101080402
#define	集宁 	101080401
#define	乌海 	101080301
#define	石拐 	101080207
#define	达尔罕茂明安联合旗 	101080206
#define	固阳 	101080205
#define	土默特右旗 	101080204
#define	满都拉 	101080203
#define	白云鄂博 	101080202
#define	包头 	101080201
#define	武川 	101080107
#define	呼和浩特市郊区 	101080106
#define	清水河 	101080105
#define	和林格尔 	101080104
#define	托克托 	101080103
#define	土默特左旗 	101080102
#define	呼和浩特 	101080101
#define	兴城 	101071404
#define	绥中 	101071403
#define	建昌 	101071402
#define	葫芦岛 	101071401
#define	盘山 	101071303
#define	大洼 	101071302
#define	盘锦 	101071301
#define	建平县 	101071207
#define	羊山 	101071206
#define	北票 	101071205
#define	喀左 	101071204
#define	凌源 	101071203
#define	建平 	101071202
#define	朝阳 	101071201
#define	西丰 	101071104
#define	昌图 	101071103
#define	开原 	101071102
#define	铁岭 	101071101
#define	灯塔 	101071003
#define	辽阳县 	101071002
#define	辽阳 	101071001
#define	彰武 	101070902
#define	阜新 	101070901
#define	盖州 	101070803
#define	大石桥 	101070802
#define	营口 	101070801
#define	北镇 	101070706
#define	黑山 	101070705
#define	义县 	101070704
#define	北宁 	101070703
#define	凌海 	101070702
#define	锦州 	101070701
#define	东沟 	101070605
#define	东港 	101070604
#define	宽甸 	101070603
#define	凤城 	101070602
#define	丹东 	101070601
#define	桓仁 	101070504
#define	草河口 	101070503
#define	本溪县 	101070502
#define	本溪 	101070501
#define	章党 	101070404
#define	清原 	101070403
#define	抚顺 	101070401
#define	海城 	101070304
#define	岫岩 	101070303
#define	台安 	101070302
#define	鞍山 	101070301
#define	海洋岛 	101070209
#define	皮口 	101070208
#define	庄河 	101070207
#define	长海 	101070206
#define	旅顺 	101070205
#define	普兰店 	101070204
#define	金州 	101070203
#define	瓦房店 	101070202
#define	大连 	101070201
#define	新城子 	101070108
#define	于洪 	101070107
#define	新民 	101070106
#define	法库 	101070105
#define	康平 	101070104
#define	辽中 	101070103
#define	苏家屯 	101070102
#define	沈阳 	101070101
#define	长白 	101060905
#define	东岗 	101060904
#define	临江 	101060903
#define	靖宇 	101060902
#define	白山 	101060901
#define	扶余 	101060805
#define	长岭 	101060804
#define	前郭 	101060803
#define	乾安 	101060802
#define	松原 	101060801
#define	东丰 	101060702
#define	辽源 	101060701
#define	通榆 	101060605
#define	镇赉 	101060604
#define	大安 	101060603
#define	洮南 	101060602
#define	白城 	101060601
#define	通化县 	101060506
#define	集安 	101060505
#define	辉南 	101060504
#define	柳河 	101060503
#define	梅河口 	101060502
#define	通化 	101060501
#define	孤家子 	101060406
#define	伊通 	101060405
#define	公主岭 	101060404
#define	梨树 	101060403
#define	双辽 	101060402
#define	四平 	101060401
#define	延边 	101060312
#define	罗子沟 	101060311
#define	松江 	101060310
#define	图们 	101060309
#define	珲春 	101060308
#define	龙井 	101060307
#define	天池 	101060306
#define	和龙 	101060305
#define	汪清 	101060304
#define	安图 	101060303
#define	敦化 	101060302
#define	延吉 	101060301
#define	烟筒山 	101060207
#define	桦甸 	101060206
#define	磐石 	101060205
#define	蛟河 	101060204
#define	永吉 	101060203
#define	舒兰 	101060202
#define	吉林 	101060201
#define	双阳 	101060106
#define	榆树 	101060105
#define	九台 	101060104
#define	德惠 	101060103
#define	农安 	101060102
#define	长春 	101060101
#define	饶河 	101051304
#define	宝清 	101051303
#define	集贤 	101051302
#define	双鸭山 	101051301
#define	萝北 	101051203
#define	绥滨 	101051202
#define	鹤岗 	101051201
#define	鸡东 	101051104
#define	密山 	101051103
#define	虎林 	101051102
#define	鸡西 	101051101
#define	勃利 	101051003
#define	七台河 	101051002
#define	杜蒙 	101050905
#define	肇源 	101050904
#define	肇州 	101050903
#define	林甸 	101050902
#define	大庆 	101050901
#define	嘉荫 	101050805
#define	铁力 	101050804
#define	五营 	101050803
#define	乌伊岭 	101050802
#define	伊春 	101050801
#define	加格达奇 	101050708
#define	阿木尔 	101050707
#define	新林 	101050706
#define	呼中 	101050705
#define	呼玛 	101050704
#define	漠河 	101050703
#define	塔河 	101050702
#define	大兴安岭 	101050701
#define	北安 	101050606
#define	五大连池 	101050605
#define	逊克 	101050604
#define	孙吴 	101050603
#define	嫩江 	101050602
#define	黑河 	101050601
#define	绥棱 	101050510
#define	庆安 	101050509
#define	青冈 	101050508
#define	兰西 	101050507
#define	望奎 	101050506
#define	明水 	101050505
#define	海伦 	101050504
#define	安达 	101050503
#define	肇东 	101050502
#define	绥化 	101050501
#define	富锦 	101050407
#define	同江 	101050406
#define	桦南 	101050405
#define	桦川 	101050404
#define	抚远 	101050403
#define	汤原 	101050402
#define	佳木斯 	101050401
#define	东宁 	101050307
#define	宁安 	101050306
#define	绥芬河 	101050305
#define	林口 	101050304
#define	穆棱 	101050303
#define	海林 	101050302
#define	牡丹江 	101050301
#define	泰来 	101050210
#define	克东 	101050209
#define	克山 	101050208
#define	拜泉 	101050207
#define	依安 	101050206
#define	富裕 	101050205
#define	甘南 	101050204
#define	龙江 	101050203
#define	讷河 	101050202
#define	齐齐哈尔 	101050201
#define	木兰 	101050113
#define	五常 	101050112
#define	尚志 	101050111
#define	延寿 	101050110
#define	方正 	101050109
#define	通河 	101050108
#define	巴彦 	101050107
#define	依兰 	101050106
#define	宾县 	101050105
#define	阿城 	101050104
#define	呼兰 	101050103
#define	双城 	101050102
#define	哈尔滨 	101050101
#define	沙坪坝 	101043700
#define	秀山 	101043600
#define	金佛山 	101043500
#define	酉阳 	101043400
#define	綦江 	101043300
#define	彭水 	101043200
#define	武隆 	101043100
#define	丰都 	101043000
#define	璧山 	101042900
#define	铜梁 	101042800
#define	荣昌 	101042700
#define	大足 	101042600
#define	石柱 	101042500
#define	忠县 	101042400
#define	梁平 	101042300
#define	垫江 	101042200
#define	潼南 	101042100
#define	巫山 	101042000
#define	奉节 	101041900
#define	巫溪 	101041800
#define	云阳 	101041700
#define	城口 	101041600
#define	开县 	101041500
#define	涪陵 	101041400
#define	万州龙宝 	101041300
#define	万州天城 	101041200
#define	黔江 	101041100
#define	长寿 	101041000
#define	巴南 	101040900
#define	北碚 	101040800
#define	渝北 	101040700
#define	万盛 	101040600
#define	江津 	101040500
#define	南川 	101040400
#define	合川 	101040300
#define	永川 	101040200
#define	重庆 	101040100
#define	蓟县 	101031400
#define	平台 	101031300
#define	大港 	101031200
#define	塘沽 	101031100
#define	津南 	101031000
#define	静海 	101030900
#define	汉沽 	101030800
#define	宁河 	101030700
#define	北辰 	101030600
#define	西青 	101030500
#define	东丽 	101030400
#define	宝坻 	101030300
#define	武清 	101030200
#define	天津 	101030100
#define	浦东 	101021300
#define	徐家汇 	101021200
#define	引水船 	101021102
#define	陈家镇 	101021101
#define	崇明 	101021100
#define	奉贤 	101021000
#define	松江 	101020900
#define	青浦 	101020800
#define	金山 	101020700
#define	南汇 	101020600
#define	嘉定 	101020500
#define	川沙 	101020400
#define	宝山 	101020300
#define	闵行 	101020200
#define	上海 	101020100
#define	霞云岭 	101012100
#define	斋堂 	101012000
#define	密云上甸子 	101011900
#define	汤河口 	101011800
#define	佛爷顶 	101011700
#define	八达岭 	101011600
#define	平谷 	101011500
#define	门头沟 	101011400
#define	密云 	101011300
#define	房山 	101011200
#define	大兴	101011100
#define	石景山 	101011000
#define	丰台 	101010900
#define	延庆 	101010800
#define	昌平 	101010700
#define	通州 	101010600
#define	怀柔 	101010500
#define	顺义 	101010400
#define	朝阳 	101010300
#define	海淀 	101010200
#define	北京 	101010100


$time = time();

# return weather information to user
function wx_weather($textTpl,$form_Content,$fromUsername,$toUsername){
    $msgType = "text";
    $contentStr = weatherdic($form_Content);
    $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);
    echo $resultStr;
    exit;
}

# return weather
function weatherdic($city)
{
    if(!empty( $city ))
   {
		$str_trans = mb_substr($city,0,3,"UTF-8");
		$str_valid = mb_substr($city,0,-3,"UTF-8");
        if($str_trans == '/:?' && !empty($str_valid))
        {				
			$citynum = mb_substr($city,3,23,"UTF-8");
            $url = "http://api2.sinaapp.com/search/weather/?appkey=0020130430&appsecert=fa6095e113cd28fd&reqtype=text&keyword=$citynum";
			$weatherJson = file_get_contents($url);
			$weather = json_decode($weatherJson, true);
			$contentStr = $weather['text']['content'];
            return($contentStr);
        }
        else if(!empty($str_valid)) return "请输入正确的城市名称！"; 
            else return "欢迎使用天气查询功能，请回复/:?加市县名！";
    }
    
}


?>